---
title: 康托展开
date: 2019-09-17 15:36:31
categories:
- ACM
- 数学
tags:
- 康托展开
---

# 康托展开

## 问题

给定某个 $[1,n]$ 的排列，求这是全排列中第几小的排列。

## 解法

考虑某个排列 $[2,3,1,4]$，从第一个元素开始看起。第一个元素是 $2$，说明首位为 $1$ 的那些已经算过了，答案要加 $(n-1)!$。 

再看第二位 $3$。比它小的元素有 $1, 2$，但是 $2$ 已经用过了，所以只考虑 $1$，它的贡献是 $(n-2)!$。

如此以往即可求出答案。

所以公示可以抽象为：$rank = a_n \times (n-1)! + a_{n-1} \times (n-2)! + ... a_0 \times 0!$

模板题：洛谷5367
# 逆康托展开

## 问题

对于 $[1,n]$ 的全排列，求其中第 $k$ 小的排列。

## 解法

比如 $n = 4, k = 10$ 的情况。

- $\frac{(k-1)}{3!} = 1$ 余数为 $3$，则这一位是所有没有用过的数字中第二（商加一）小的，即 $2$。
- $\frac{(3)}{2!} = 1$ 余数为 $1$，则这一位是所有没有用过的数字中第二（商加一）小的，即 $3$。
- $\frac{(1)}{1!} = 1$ 余数为 $0$，则这一位是所有没有用过的数字中第二（商加一）小的，即 $4$。
- 最后一位就是还没用过的那个数字。